
<!-- *********** Curent Match active section *********** -->

<!-- ***** Game information ***** -->
<%= render 'layouts/header'  %>

<div class="non_nav">
  <% if @game %>
  <div class="current_match_header">
    <h1><%=@game.name%></h1>
    <h4><%=@game.description%></h2>
    </div>

    <!-- ***** Display players in order (OR maybe team vs team layout) ***** -->
    <div class="row">

      <div class="col-md-6 team_show">

        <% @home_team_users.each do |player| %>

        <div class="col-md-3 team_player team_a">
          <img src="<%=player.profile_img%>" alt="" class="img-circle team_match_image">
          <p><%=player.firstname%> <%=player.lastname%></p>
          <p><%=player.city%>, <%=player.state%></p>
        </div>

        <%end%>
      </div>

      <div class="col-md-6 team_show">

       <% @away_team_users.each do |player| %>

       <div class="col-md-3 team_player team_b">
        <img src="<%=player.profile_img%>" alt="" class="img-circle team_match_image">
        <p><%=player.firstname%> <%=player.lastname%></p>
        <p><%=player.city%>, <%=player.state%></p>
      </div>

      <%end%>
    </div>
  </div><!-- end row -->

  <br><br>

  <!-- ***** Current score ***** -->

  <div class="row">

    <div class="col-md-5 team_show team_a">
      <h3 class="team_name_display"><%=@home_team.name%></h3>
    </div>


    <div class="col-md-2 team_show">
      <div id="hidden_end_time"><%=@end_time%></div>

      <h3><div class="our_countdown"></div>
        <script type="text/javascript">
        $(".our_countdown")
        .countdown($("#hidden_end_time").text(), function(event) {
          $(this).text(
            event.strftime('%D days %H:%M:%S')
            );
        });
      </script></h3>

    </div>

    <div class="col-md-5 team_show team_b">
      <h3 class="team_name_display"><%=@away_team.name%></h3>
    </div>

  </div>


  <div class="row">
    <div class="col-md-5 team_show team_a">
      <h1><%=@home_total%> meters</h1>
    </div>
    <div class="col-md-2 team_show">
      <h1 class="lobstah">VS.</h1>
    </div>
    <div class="col-md-5 team_show team_b">
      <h1><%=@away_total%> meters</h1>
    </div>
  </div>
  <br><br><br>

  <!-- ***** Team A run logs ***** -->

  <div class="row">

    <div class="col-md-4 team_show team_a">
      <ul class="list-group">
        <% @home_activities.each do |activity| %>

        <li class="list-group-item"><%=activity.user.firstname%> <%=activity.user.lastname%> ran <%=activity.distance%> meters <a href="" data-toggle="modal" data-target="#myModal"> <i class="fa fa-map-marker"></i></a></li>

        <div id="myModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-body">
                <img src="<%=activity.map_polyline%>" class="img-responsive">
              </div>
            </div>
          </div>
        </div>

        <%end%>
      </ul>
    </div>
<!--
    <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#myModal">Popup image</button>

    <div id="myModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-body">
            <img src="//placehold.it/1000x600" class="img-responsive">
          </div>
        </div>
      </div>
    </div> -->

    <script>
    function centerModal() {
      $(this).css('display', 'block');
      var $dialog = $(this).find(".modal-dialog");
      var offset = ($(window).height() - $dialog.height()) / 2;
    // Center modal vertically in window
    $dialog.css("margin-top", offset);
  }
  $('.modal').on('show.bs.modal', centerModal);
  $(window).on("resize", function () {
    $('.modal:visible').each(centerModal);
  });

  </script>

  <!-- ***** Talk shit forum ***** -->

  <div class="col-md-4 team_show">

    <div class="title_box">
      <label>Talk Shit</label>
    </div>

    <div class="actionBox">


      <%= form_for :trash_talk, format: :json, url: trash_talks_path, remote: true,  html: { id: "trashtalk"} do |f| %>
      <%= f.text_field :content %>
      <%= f.hidden_field :user_id, :value => @user.id %>
      <%= f.hidden_field :game_id, :value => @game.id %>
      <%= f.submit %>
      <% end %>


      <ul class="commentList">
        <% @game.trash_talks.order("created_at DESC").each do |trashtalk| %>
        <li>
          <div class="commenterImage">
            <img src=<%=@user.profile_img %> />
          </div>
          <div class="commentText">
            <p class=""><%=trashtalk.content%></p> <span class="date sub-text"><%=trashtalk.created_at%></span>
          </div>
        </li>
        <%end%>
        <%= render 'trash_talk_template' %>
      </ul>
    </div> <!-- actin box ends -->
  </div>


  <!-- ***** Team B run logs ***** -->

  <div class="col-md-4 team_show team_b">
      <ul class="list-group">
        <% @away_activities.each do |activity| %>

        <li class="list-group-item"><%=activity.user.firstname%> <%=activity.user.lastname%> ran <%=activity.distance%> meters <a href="" data-toggle="modal" data-target="#myModal"> <i class="fa fa-map-marker"></i></a></li>

        <div id="myModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
              <div class="modal-body">
                <img src="<%=activity.map_polyline%>" class="img-responsive">
              </div>
            </div>
          </div>
        </div>

        <%end%>
      </ul>
    </div>

</div>
<% else %>
<h3>Not in a game</h3>
<% end %>
</div>
